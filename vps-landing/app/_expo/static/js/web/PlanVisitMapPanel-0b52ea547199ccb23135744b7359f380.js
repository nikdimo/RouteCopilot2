__d(function(g,r,_i,_a,m,_e,d){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,"default",{enumerable:!0,get:function(){return f}});var t=r(d[0]),n=e(r(d[1])),i=e(r(d[2])),o=r(d[3]),l=e(r(d[4])),a=r(d[5]);r(d[6]),r(d[7]),r(d[8]);var s=r(d[9]);function c(e,t){return l.default.divIcon({className:'plan-visit-marker',html:`<div style="\n      width:28px;height:28px;border-radius:14px;background:${e};\n      border:2px solid #fff;box-shadow:0 1px 2px rgba(0,0,0,0.2);\n      display:flex;align-items:center;justify-content:center;\n      color:#fff;font-size:12px;font-weight:700;\n    ">${t}</div>`,iconSize:[28,28],iconAnchor:[14,14]})}function u({coords:e}){const n=(0,o.useMap)();return(0,t.useEffect)(()=>{if(0!==e.length)try{1===e.length?n.setView(e[0],14):n.fitBounds(l.default.latLngBounds(e),{padding:[40,40],maxZoom:14})}catch{}},[n,e]),null}const p=[55.6761,12.5683],h=10;function f({newLocation:e,slot:t,dayEvents:i=[],homeBase:l}){const f=[l.lat,l.lon],y=null!=e?[e.lat,e.lon]:null,j=null!=t&&null!=e&&i.length>0?(0,a.buildRouteWithInsertion)(i,e,t,l):[],w=j.length>=2?j.map(e=>[e.latitude,e.longitude]):[],b=w.length>=2?w:null!=y?[f,y]:[f];return(0,s.jsx)(n.default,{style:x.container,children:(0,s.jsx)("div",{style:x.mapWrapper,children:(0,s.jsxs)(o.MapContainer,{center:p,zoom:h,scrollWheelZoom:!0,style:x.leafletMap,children:[(0,s.jsx)(o.TileLayer,{attribution:"\xa9 <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,s.jsx)(u,{coords:b}),(0,s.jsx)(o.Marker,{position:f,icon:c('#107C10','H')}),null!=y&&(0,s.jsx)(o.Marker,{position:y,icon:c('#D13438','!')}),i.filter(e=>null!=e.coordinates).map((e,t)=>(0,s.jsx)(o.Marker,{position:[e.coordinates.latitude,e.coordinates.longitude],icon:c('#0078D4',String(t+1))},e.id)),w.length>=2&&(0,s.jsx)(o.Polyline,{positions:w,pathOptions:{color:'#00B0FF',weight:4}})]})})})}const x=i.default.create({container:{flex:1,minHeight:200},mapWrapper:{width:'100%',height:'100%',minHeight:200,position:'relative'},leafletMap:{width:'100%',height:'100%',minHeight:200}})},3110,[36,219,44,3112,3113,3117,3114,3115,3116,153]);
__d(function(g,r,_i,_a,m,e,_d){"use strict";Object.defineProperty(e,'__esModule',{value:!0}),e.buildRouteWithInsertion=function(n,l,o,s){const a={latitude:s.lat,longitude:s.lon},u={latitude:l.lat,longitude:l.lon},c=n.filter(t=>null!=t.coordinates),[f,d,p]=o.dayIso.split('-').map(t=>parseInt(t,10)),I=(0,t.startOfDay)(new Date(f,d-1,p)).getTime(),h=[...c].sort((t,n)=>(i(t,I)??0)-(i(n,I)??0)),y=o.startMs;let _=h.length;for(let t=0;t<h.length;t++){const n=i(h[t],I);if(null!=n&&y<n){_=t;break}}const b=[...h.slice(0,_).map(t=>t.coordinates),u,...h.slice(_).map(t=>t.coordinates)];return[a,...b,a]};var t=r(_d[0]);const n=6e4;function i(t,n){if(t.startIso)try{return new Date(t.startIso).getTime()}catch{return l(t.time,n)}return l(t.time,n)}function l(t,i){if(!t||'string'!=typeof t)return null;const l=t.split('-').map(t=>t.trim());if(l.length<2)return null;const[o,s]=(l[0]??'00:00').split(':').map(t=>parseInt(t||'0',10));return i+(60*o+s)*n}},3117,[846]);